# 剪贴板监听工具

一个使用PySide6开发的剪贴板监听工具，可以自动保存复制的内容，并提供查看、导出和复制功能。

## 功能特点

- **自动监听剪贴板**：实时监听剪贴板内容变化
- **自动保存**：每次复制内容都会自动保存到本地文件
- **历史记录**：保存所有剪贴板历史，可随时查看
- **内容预览**：在界面中预览剪贴板内容
- **一键复制**：可将历史记录中的内容复制回剪贴板
- **导出功能**：支持将所有历史记录导出为文本文件
- **清空历史**：可清空所有历史记录和文件
- **系统托盘**：支持最小化到系统托盘，方便后台运行
- **全局热键**：支持全局热键快速调用主窗口
- **实时索引**：历史记录索引实时更新，快速检索

## 安装与运行

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行程序

```bash
python main.py
```

## 使用方法

1. **启动程序**：运行`main.py`文件
2. **复制内容**：正常复制任何文本内容，程序会自动监听并保存
3. **查看历史**：在左侧列表中可以看到所有剪贴板历史记录（按时间倒序排列）
4. **预览内容**：点击列表中的任意项，右侧会显示完整内容
5. **复制到剪贴板**：选中列表项后，点击"复制到剪贴板"按钮
6. **导出历史**：点击"导出历史"按钮，选择保存位置
7. **清空历史**：点击"清空历史"按钮，确认后删除所有记录
8. **系统托盘**：关闭窗口时程序会最小化到系统托盘，右键托盘图标可以退出程序
9. **全局热键**：使用快捷键Ctrl+空格可以快速调出主窗口

## 文件结构

```
py剪贴板/
├── main.py              # 主程序入口
├── requirements.txt     # 依赖列表
├── README.md            # 说明文档
├── resources/          # 资源文件目录（图标、样式等）
├── clipboard_history/   # 自动创建的保存目录
│   ├── history_index.json  # 历史记录索引
│   └── clipboard_*.txt     # 各个剪贴板内容文件
└── src/                # 源代码目录
    ├── core/           # 核心功能模块
    │   ├── clipboard_manager.py  # 剪贴板管理器
    │   ├── clipboard_monitor.py   # 剪贴板监控器
    │   └── history_item.py       # 历史记录项
    ├── ui/             # 用户界面模块
    │   ├── main_window.py         # 主窗口
    │   ├── list_item.py           # 列表项
    │   ├── list_widget.py         # 列表控件
    │   └── tray_icon.py           # 托盘图标
    └── utils/          # 工具模块
        └── hotkey_listener.py     # 全局热键监听器
```

## 技术实现

- **GUI框架**：PySide6
- **剪贴板监听**：使用QTimer定期检查剪贴板变化
- **多线程**：使用QThread实现剪贴板监听，避免阻塞主界面
- **文件存储**：每个剪贴板内容保存为单独文件，并维护索引文件
- **模块化设计**：采用MVC架构，代码结构清晰，易于维护和扩展
- **实时索引**：历史记录索引实时更新，支持快速检索和排序
- **系统托盘集成**：支持最小化到系统托盘，提供右键菜单

## 注意事项

- 程序会自动创建`clipboard_history`目录用于存储剪贴板内容
- 每个剪贴板内容都会保存为单独的文本文件
- 历史记录索引保存在`history_index.json`文件中，并实时更新
- 清空历史会删除所有已保存的文件，请谨慎操作
- 程序关闭后会最小化到系统托盘，可通过托盘图标右键菜单完全退出
- 使用全局热键功能需要管理员权限（在某些系统上）